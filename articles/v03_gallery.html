<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analytics Gallery with tidycensuskr • tidycensussfkr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analytics Gallery with tidycensuskr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidycensussfkr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01_intro.html">Working with tidycensuskr</a></li>
    <li><a class="dropdown-item" href="../articles/v02_regional_analysis.html">Regional analysis with tidycensuskr</a></li>
    <li><a class="dropdown-item" href="../articles/v03_gallery.html">Analytics Gallery with tidycensuskr</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sigmafelix/tidycensussfkr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analytics Gallery with tidycensuskr</h1>
            
            <h4 data-toc-skip class="date">October 11, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sigmafelix/tidycensussfkr/blob/main/vignettes/v03_gallery.Rmd" class="external-link"><code>vignettes/v03_gallery.Rmd</code></a></small>
      <div class="d-none name"><code>v03_gallery.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="example-1-spatial-autocorrelation-of-economic-activity-in-south-korea">Example 1: Spatial autocorrelation of economic activity in South
Korea<a class="anchor" aria-label="anchor" href="#example-1-spatial-autocorrelation-of-economic-activity-in-south-korea"></a>
</h2>
<div class="section level3">
<h3 id="design-idea">Design idea<a class="anchor" aria-label="anchor" href="#design-idea"></a>
</h3>
<p>In this example, we use Moran’s <em>I</em> statistics to analyze the
spatial distribution of economic activity (measured by the number of
registered companies) across South Korea in 2020.</p>
<ul>
<li>Global Moran’s I evaluates whether there is overall spatial
autocorrelation, i.e., whether areas with similar company counts tend to
cluster together nationwide.</li>
<li>Local Moran’s I (LISA) identifies local clusters and outliers by
classifying each district into four types:
<ul>
<li>High-High (H-H): districts with high values surrounded by other
high-value districts.</li>
<li>Low-Low (L-L): districts with low values surrounded by other
low-value districts.</li>
<li>High-Low (H-L): potential spatial outliers with high values
surrounded by low-value neighbors.</li>
<li>Low-High (L-H): potential spatial outliers with low values
surrounded by high-value neighbors.</li>
</ul>
</li>
</ul>
<p>The resulting LISA cluster map highlights where economic activities
are concentrated and where they are sparse relative to neighboring
areas.</p>
</div>
<div class="section level3">
<h3 id="data-prep">Data prep<a class="anchor" aria-label="anchor" href="#data-prep"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load 2020 boundaries</span></span>
<span><span class="va">sf_2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sigmafelix.github.io/tidycensuskr/reference/load_districts.html" class="external-link">load_districts</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load 2020 economy data</span></span>
<span><span class="va">df_2020_economy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sigmafelix.github.io/tidycensuskr/reference/anycensus.html" class="external-link">anycensus</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span>, </span>
<span>                             type <span class="op">=</span> <span class="st">"economy"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge with spatial data</span></span>
<span><span class="va">sf_2020_economy</span> <span class="op">&lt;-</span> <span class="va">sf_2020</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">inner_join</span><span class="op">(</span><span class="va">df_2020_economy</span>, by <span class="op">=</span> <span class="st">"adm2_code"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Variable of interest: number of companies</span></span>
<span><span class="va">var</span> <span class="op">&lt;-</span> <span class="va">sf_2020_economy</span><span class="op">$</span><span class="va">company_total_cnt</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="global-morans-i">Global Moran’s I<a class="anchor" aria-label="anchor" href="#global-morans-i"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build neighbors (queen contiguity) and spatial weights</span></span>
<span><span class="va">nb</span> <span class="op">&lt;-</span> <span class="fu">poly2nb</span><span class="op">(</span><span class="va">sf_2020_economy</span>, queen <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">nb2listw</span><span class="op">(</span><span class="va">nb</span>, style <span class="op">=</span> <span class="st">"W"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Global Moran's I test</span></span>
<span><span class="va">global_moran</span> <span class="op">&lt;-</span> <span class="fu">moran.test</span><span class="op">(</span><span class="va">var</span>, <span class="va">lw</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">global_moran</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Moran I test under randomisation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  var  </span></span>
<span><span class="co">## weights: lw  </span></span>
<span><span class="co">## n reduced by no-neighbour observations  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Moran I statistic standard deviate = 10.35, p-value &lt; 2.2e-16</span></span>
<span><span class="co">## alternative hypothesis: greater</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## Moran I statistic       Expectation          Variance </span></span>
<span><span class="co">##       0.424571643      -0.004149378       0.001715960</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="local-morans-i-and-lisa-map">Local Moran’s <em>I</em> and LISA map<a class="anchor" aria-label="anchor" href="#local-morans-i-and-lisa-map"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Local Moran's I</span></span>
<span><span class="va">local_moran</span> <span class="op">&lt;-</span> <span class="fu">localmoran</span><span class="op">(</span><span class="va">var</span>, <span class="va">lw</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bind results back to sf object</span></span>
<span><span class="va">sf_2020_economy</span> <span class="op">&lt;-</span> <span class="va">sf_2020_economy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    Ii   <span class="op">=</span> <span class="va">local_moran</span><span class="op">[</span>, <span class="st">"Ii"</span><span class="op">]</span>,</span>
<span>    pval <span class="op">=</span> <span class="va">local_moran</span><span class="op">[</span>, <span class="st">"Pr(z != E(Ii))"</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">mean_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">var</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sf_2020_economy</span> <span class="op">&lt;-</span> <span class="va">sf_2020_economy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    cluster <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">var</span> <span class="op">&gt;</span> <span class="va">mean_var</span> <span class="op">&amp;</span> <span class="va">Ii</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span> <span class="op">~</span> <span class="st">"High-High"</span>,</span>
<span>      <span class="va">var</span> <span class="op">&lt;</span> <span class="va">mean_var</span> <span class="op">&amp;</span> <span class="va">Ii</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span> <span class="op">~</span> <span class="st">"Low-Low"</span>,</span>
<span>      <span class="va">var</span> <span class="op">&gt;</span> <span class="va">mean_var</span> <span class="op">&amp;</span> <span class="va">Ii</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span> <span class="op">~</span> <span class="st">"High-Low"</span>,</span>
<span>      <span class="va">var</span> <span class="op">&lt;</span> <span class="va">mean_var</span> <span class="op">&amp;</span> <span class="va">Ii</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span> <span class="op">~</span> <span class="st">"Low-High"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Not significant"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sf_2020_economy</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey70"</span>, size <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"High-High"</span>     <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>      <span class="st">"Low-Low"</span>       <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>      <span class="st">"High-Low"</span>      <span class="op">=</span> <span class="st">"pink"</span>,</span>
<span>      <span class="st">"Low-High"</span>      <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>      <span class="st">"Not significant"</span> <span class="op">=</span> <span class="st">"white"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"LISA Cluster Map of Company units (2020)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="v03_gallery_files/figure-html/local_moran_1,%20-1.png" width="672"></p>
<p>The results reveal a strong metropolitan concentration of economic
activity. High-High (H-H) clusters are predominantly located in the
Seoul Metropolitan Area, reflecting its central role in South Korea’s
economy. Low-Low (L-L) clusters appear in Gangwon Province and along the
borders of Jeollabuk-do, Jeollanam-do, Gyeongsangbuk-do, and
Chungcheongnam-do, indicating regions with consistently low levels of
company presence. This spatial pattern highlights the dominance of the
capital region in economic activity and the relative sparsity of
industrial and business units in peripheral provinces.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Insang Song, Sohyun Park, Hyesop Shin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
